<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Traffic Signal Chat — Leaflet + Firebase</title>

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <!-- Firebase (compat, matches previous usage) -->
    <script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-database-compat.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">

    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <div id="map"></div>

    <!-- Speed and Traffic Data -->
    <div id="traffic-toggle">🚦 Traffic Info</div>

    <div id="traffic-box">
        <span><b>Signal:</b> <span id="traffic-signal">--</span></span>
        <span><b>Spd:</b> <span id="traffic-speed">--</span>km/h</span>
        <span><b>Spd FF:</b> <span id="traffic-freeflow">--</span>km/h</span>
        <span><b>TT:</b> <span id="traffic-travel">--</span>s</span>
        <span><b>TTF:</b> <span id="traffic-freeflowtime">--</span>s</span>
        <span><b>Clo:</b> <span id="traffic-closure">--</span></span>
    </div>


    <!-- Chat panel (right) -->
    <div id="chatPanel" class="chat-panel" aria-hidden="true">
        <div class="chat-header">
            <div id="chatTitle">Signal Chat</div>
            <div class="actions">
                <button id="minimizeChatBtn" class="icon-btn" title="Minimize">−</button>
            </div>
        </div>

        <div class="chat-body">
            <div class="messages" id="messages"></div>
        </div>

        <div class="chat-input-area">
            <div class="preset-row">
                <select id="preset-select" aria-label="Select preset message">
                    <option value="">— Select a message —</option>
                    <option value="Heavy traffic due to accident">🚧 Heavy traffic due to accident</option>
                    <option value="Traffic moving slowly">🐢 Traffic moving slowly</option>
                    <option value="Road blocked temporarily">⛔ Road blocked temporarily</option>
                    <option value="Signal not working">⚠️ Signal not working</option>
                    <option value="Police checking ongoing">👮 Police checking ongoing</option>
                    <option value="Flooded road">🌊 Flooded road</option>
                    <option value="Construction work ahead">🏗️ Construction work ahead</option>
                    <option value="Clear road">✅ Clear road</option>
                </select>
            </div>
            <input id="custom-note" type="text" placeholder="Add details (optional)" />
            <button id="send-btn">Send</button>
        </div>
    </div>

    <!-- Video/simulation popup (left) -->
    <div id="videoPanel" class="video-popup w-50" aria-hidden="true">
        <div class="video-header">
            <div id="videoTitle">Simulation</div>
            <div class="v-actions">
                <button id="videoMinimizeBtn" title="Minimize">−</button>
                <button id="videoMaximizeBtn" title="Maximize">⬜</button>
            </div>
        </div>
        <div id="videoLoading" style="
    display: none;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0,0,0,0.6);
    color: white;
    padding: 10px 20px;
    border-radius: 8px;
    font-family: sans-serif;
">
            Loading video...
        </div>

        <div class="video-body" id="videoBody">
            <video id="simulationVideo" autoplay muted loop playsinline>
                <source src="videos/simulation.mp4" type="video/mp4">
            </video>
        </div>
    </div>
    <script src="script.js"></script>


</body>

</html>